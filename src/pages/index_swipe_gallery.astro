---
import astroConfig from "../../astro.config.mjs";
import Layout from "../components/layout_components/layout.astro";
import AnnotatedLink from "../components/prose_components/annotatedLink.astro";
import { LINKS } from "../lib/linkHelper";
import { getPhotoByName as p } from "../lib/photoHelper";

const flexCenter =
    "flex w-full h-full items-center justify-center px-4 pt-14 mt-4 pb-16 sm:pt-4 sm:pb-4";
---

<Layout>
    <div class="swiper w-full h-svh">
        <div class="swiper-wrapper">
            <div
                class="swiper-slide"
                data-caption={p("2021-01-14-north-atlantic-pennance-point")
                    .joinedCaption}
                data-from-link={astroConfig.base + LINKS.horizons}
                data-from-text="Horizons"
            >
                <div class={flexCenter}>
                    <img
                        src={p("2021-01-14-north-atlantic-pennance-point").paths
                            .large}
                        alt={p("2021-01-14-north-atlantic-pennance-point")
                            .joinedCaption}
                        draggable="false"
                        class="max-w-[600px] select-none cursor-crosshair border-4 border-[#e2e8f0]"
                    />
                </div>
            </div>
            <div
                class="swiper-slide"
                data-caption={p("2024-04-26-forest-library-isle-of-wight")
                    .joinedCaption}
                data-from-link={astroConfig.base + LINKS.palimpsest}
                data-from-text="Palimpsest"
            >
                <div class={flexCenter}>
                    <img
                        src={p("2024-04-26-forest-library-isle-of-wight").paths
                            .large}
                        alt={p("2024-04-26-forest-library-isle-of-wight")
                            .joinedCaption}
                        draggable="false"
                        class="max-w-[400px] select-none cursor-crosshair border-[3px] border-[#C8CDB9]"
                    />
                </div>
            </div>
            <div
                class="swiper-slide"
                data-caption={p("2019-08-31-cycling-gudmundsen-drive-door-county").joinedCaption}
                data-from-link={astroConfig.base + LINKS.heartland}
                data-from-text="Heartland"
            >
                <div class={flexCenter}>
                    <img
                        src={p("2019-08-31-cycling-gudmundsen-drive-door-county").paths.large}
                        alt={p("2019-08-31-cycling-gudmundsen-drive-door-county").joinedCaption}
                        draggable="false"
                        class="max-w-[600px] select-none cursor-crosshair shadow-[4px_4px_0px_rgba(0,0,0,0.8)]"
                    />
                </div>
            </div>
            <div
                class="swiper-slide"
                data-caption={p("2024-05-17-bear-witness-belsize-park")
                    .joinedCaption}
                data-from-link={astroConfig.base + LINKS.palimpsest}
                data-from-text="Palimpsest"
            >
                <div class={flexCenter + " gap-3 sm:gap-4"}>
                    <img
                        src={p("2024-09-03-shed-train-window-weymouth").paths
                            .medium}
                        alt={p("2024-09-03-shed-train-window-weymouth")
                            .joinedCaption}
                        draggable="false"
                        class="max-w-[270px] w-[calc(50%-0.5rem)] select-none cursor-crosshair"
                    />
                    <img
                        src={p("2024-05-17-bear-witness-belsize-park").paths
                            .medium}
                        alt={p("2024-05-17-bear-witness-belsize-park")
                            .joinedCaption}
                        draggable="false"
                        class="max-w-[270px] w-[calc(50%-0.5rem)] select-none cursor-crosshair border-[3px] border-[#0A0907]"
                    />
                </div>
            </div>
            <div
                class="swiper-slide"
                data-caption={p("2024-05-25-la-corbiere-st-brelade-jersey")
                    .joinedCaption}
                data-from-link={astroConfig.base + LINKS.palimpsest}
                data-from-text="Palimpsest"
            >
                <div class={flexCenter}>
                    <img
                        src={p("2024-05-25-la-corbiere-st-brelade-jersey").paths
                            .large}
                        alt={p("2024-05-25-la-corbiere-st-brelade-jersey")
                            .joinedCaption}
                        draggable="false"
                        class="max-w-[600px] select-none cursor-crosshair shadow-[4px_4px_0_rgba(10,_114,_123,_0.09)]"
                    />
                </div>
            </div>
        </div>
    </div>
    <span slot="bottomleft" data-caption-container class="hidden sm:inline">
        {p("2021-01-14-north-atlantic-pennance-point").joinedCaption}
    </span>
    <span slot="bottomright" class="hidden sm:inline sm:text-black">
        <span>From:</span>
        <AnnotatedLink
            data-from-link-container
            type="circle"
            staticUnderline={true}>Horizons</AnnotatedLink
        >
    </span>
    <script>
        import Swiper from "swiper";
        import {} from "swiper/modules";
        import "swiper/css";

        document.addEventListener("DOMContentLoaded", function () {
            const swiper = new Swiper(".swiper", {
                on: {
                    realIndexChange: (s) => {
                        const data = (
                            s.wrapperEl.children[s.realIndex] as HTMLElement
                        ).dataset;
                        const fromLink = document.querySelector(
                            "[data-from-link-container]"
                        );
                        fromLink.innerHTML = data.fromText;
                        fromLink["href"] = data.fromLink;
                        document.querySelector(
                            "[data-caption-container]"
                        ).innerHTML = data.caption;
                    },
                },
                modules: [],
                // spaceBetween: 0,
                // loop: true,
                rewind: true,
                simulateTouch: false, // controls whether mouse can swipe
                breakpoints: {
                    640: {
                        simulateTouch: false, // only simulate touch on small screens
                    },
                },
            });

            swiper.el.querySelectorAll("img").forEach((e) =>
                e.addEventListener("click", () => {
                    if (window.innerWidth >= 640) {
                        swiper.slideNext(0, true);
                    }
                })
            );

            document.addEventListener("keydown", (e) => {
                if (e.key === "ArrowLeft") {
                    swiper.slidePrev(0, true);
                } else if (e.key === "ArrowRight") {
                    swiper.slideNext(0, true);
                }
            });
        });
    </script>
</Layout>
